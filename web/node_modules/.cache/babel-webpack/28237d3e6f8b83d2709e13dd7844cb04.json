{"ast":null,"code":"import _classCallCheck from \"/home/sarwar/wsit/wearit-backend/web/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/sarwar/wsit/wearit-backend/web/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, EventEmitter, HostListener, Input, NgModule, Output } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { DomSanitizer } from '@angular/platform-browser';\nimport * as ɵngcc0 from '@angular/core';\nimport * as ɵngcc1 from '@angular/platform-browser';\n\nvar ImageUtils = /*#__PURE__*/function () {\n  function ImageUtils() {\n    _classCallCheck(this, ImageUtils);\n  }\n\n  _createClass(ImageUtils, null, [{\n    key: \"getOrientation\",\n    value:\n    /**\n     * @param {?} imageBase64\n     * @return {?}\n     */\n    function getOrientation(imageBase64) {\n      var\n      /** @type {?} */\n      view = new DataView(this.base64ToArrayBuffer(imageBase64));\n\n      if (view.getUint16(0, false) != 0xFFD8) {\n        return -2;\n      }\n\n      var\n      /** @type {?} */\n      length = view.byteLength;\n      var\n      /** @type {?} */\n      offset = 2;\n\n      while (offset < length) {\n        if (view.getUint16(offset + 2, false) <= 8) return -1;\n        var\n        /** @type {?} */\n        marker = view.getUint16(offset, false);\n        offset += 2;\n\n        if (marker == 0xFFE1) {\n          if (view.getUint32(offset += 2, false) != 0x45786966) {\n            return -1;\n          }\n\n          var\n          /** @type {?} */\n          little = view.getUint16(offset += 6, false) == 0x4949;\n          offset += view.getUint32(offset + 4, little);\n          var\n          /** @type {?} */\n          tags = view.getUint16(offset, little);\n          offset += 2;\n\n          for (var\n          /** @type {?} */\n          i = 0; i < tags; i++) {\n            if (view.getUint16(offset + i * 12, little) == 0x0112) {\n              return view.getUint16(offset + i * 12 + 8, little);\n            }\n          }\n        } else if ((marker & 0xFF00) != 0xFF00) {\n          break;\n        } else {\n          offset += view.getUint16(offset, false);\n        }\n      }\n\n      return -1;\n    }\n    /**\n     * @param {?} imageBase64\n     * @return {?}\n     */\n\n  }, {\n    key: \"base64ToArrayBuffer\",\n    value: function base64ToArrayBuffer(imageBase64) {\n      imageBase64 = imageBase64.replace(/^data\\:([^\\;]+)\\;base64,/gmi, '');\n      var\n      /** @type {?} */\n      binaryString = atob(imageBase64);\n      var\n      /** @type {?} */\n      len = binaryString.length;\n      var\n      /** @type {?} */\n      bytes = new Uint8Array(len);\n\n      for (var\n      /** @type {?} */\n      i = 0; i < len; i++) {\n        bytes[i] = binaryString.charCodeAt(i);\n      }\n\n      return bytes.buffer;\n    }\n    /**\n     * @param {?} srcBase64\n     * @param {?} srcOrientation\n     * @param {?} callback\n     * @return {?}\n     */\n\n  }, {\n    key: \"resetOrientation\",\n    value: function resetOrientation(srcBase64, srcOrientation, callback) {\n      var\n      /** @type {?} */\n      img = new Image();\n\n      img.onload = function () {\n        var\n        /** @type {?} */\n        width = img.width;\n        var\n        /** @type {?} */\n        height = img.height;\n        var\n        /** @type {?} */\n        canvas = document.createElement('canvas');\n        var\n        /** @type {?} */\n        ctx = canvas.getContext('2d');\n\n        if (ctx) {\n          if (4 < srcOrientation && srcOrientation < 9) {\n            canvas.width = height;\n            canvas.height = width;\n          } else {\n            canvas.width = width;\n            canvas.height = height;\n          }\n\n          ImageUtils.transformCanvas(ctx, srcOrientation, width, height);\n          ctx.drawImage(img, 0, 0);\n          callback(canvas.toDataURL());\n        } else {\n          callback(srcBase64);\n        }\n      };\n\n      img.src = srcBase64;\n    }\n    /**\n     * @param {?} ctx\n     * @param {?} orientation\n     * @param {?} width\n     * @param {?} height\n     * @return {?}\n     */\n\n  }, {\n    key: \"transformCanvas\",\n    value: function transformCanvas(ctx, orientation, width, height) {\n      switch (orientation) {\n        case 2:\n          ctx.transform(-1, 0, 0, 1, width, 0);\n          break;\n\n        case 3:\n          ctx.transform(-1, 0, 0, -1, width, height);\n          break;\n\n        case 4:\n          ctx.transform(1, 0, 0, -1, 0, height);\n          break;\n\n        case 5:\n          ctx.transform(0, 1, 1, 0, 0, 0);\n          break;\n\n        case 6:\n          ctx.transform(0, 1, -1, 0, height, 0);\n          break;\n\n        case 7:\n          ctx.transform(0, -1, -1, 0, height, width);\n          break;\n\n        case 8:\n          ctx.transform(0, -1, 1, 0, 0, width);\n          break;\n\n        default:\n          break;\n      }\n    }\n  }]);\n\n  return ImageUtils;\n}();\n\nvar ImageCropperComponent = /*#__PURE__*/function () {\n  /**\n   * @param {?} elementRef\n   * @param {?} sanitizer\n   * @param {?} cd\n   */\n  function ImageCropperComponent(elementRef, sanitizer, cd) {\n    _classCallCheck(this, ImageCropperComponent);\n\n    this.elementRef = elementRef;\n    this.sanitizer = sanitizer;\n    this.cd = cd;\n    this.marginLeft = '0px';\n    this.imageVisible = false;\n    this.format = 'png';\n    this.maintainAspectRatio = true;\n    this.aspectRatio = 1;\n    this.resizeToWidth = 0;\n    this.onlyScaleDown = false;\n    this.imageQuality = 92;\n    this.cropper = {\n      x1: -100,\n      y1: -100,\n      x2: 10000,\n      y2: 10000\n    };\n    this.imageCropped = new EventEmitter();\n    this.imageLoaded = new EventEmitter();\n    this.loadImageFailed = new EventEmitter();\n    this.initCropper();\n  }\n  /**\n   * @param {?} file\n   * @return {?}\n   */\n\n\n  _createClass(ImageCropperComponent, [{\n    key: \"imageFileChanged\",\n    set: function set(file) {\n      this.initCropper();\n\n      if (file) {\n        this.loadImageFile(file);\n      }\n    }\n    /**\n     * @param {?} event\n     * @return {?}\n     */\n\n  }, {\n    key: \"imageChangedEvent\",\n    set: function set(event) {\n      this.initCropper();\n\n      if (event && event.target && event.target.files && event.target.files.length > 0) {\n        this.loadImageFile(event.target.files[0]);\n      }\n    }\n    /**\n     * @param {?} imageBase64\n     * @return {?}\n     */\n\n  }, {\n    key: \"imageBase64\",\n    set: function set(imageBase64) {\n      this.initCropper();\n      this.loadBase64Image(imageBase64);\n    }\n    /**\n     * @param {?} changes\n     * @return {?}\n     */\n\n  }, {\n    key: \"ngOnChanges\",\n    value: function ngOnChanges(changes) {\n      var _this = this;\n\n      if (changes['cropper']) {\n        setTimeout(function () {\n          _this.setMaxSize();\n\n          _this.checkCropperPosition(false);\n\n          _this.crop();\n\n          _this.cd.markForCheck();\n        });\n      }\n    }\n    /**\n     * @return {?}\n     */\n\n  }, {\n    key: \"initCropper\",\n    value: function initCropper() {\n      this.imageVisible = false;\n      this.originalImage = null;\n      this.safeImgDataUrl = 'data:image/png;base64,iVBORw0KGg' + 'oAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAU' + 'AAarVyFEAAAAASUVORK5CYII=';\n      this.moveStart = {\n        active: false,\n        type: null,\n        position: null,\n        x1: 0,\n        y1: 0,\n        x2: 0,\n        y2: 0,\n        clientX: 0,\n        clientY: 0\n      };\n      this.maxSize = {\n        width: 0,\n        height: 0\n      };\n      this.originalSize = {\n        width: 0,\n        height: 0\n      };\n      this.cropper.x1 = -100;\n      this.cropper.y1 = -100;\n      this.cropper.x2 = 10000;\n      this.cropper.y2 = 10000;\n    }\n    /**\n     * @param {?} file\n     * @return {?}\n     */\n\n  }, {\n    key: \"loadImageFile\",\n    value: function loadImageFile(file) {\n      var _this2 = this;\n\n      var\n      /** @type {?} */\n      fileReader = new FileReader();\n\n      fileReader.onload = function (event) {\n        var\n        /** @type {?} */\n        imageType = file.type;\n\n        if (_this2.isValidImageType(imageType)) {\n          _this2.checkExifRotationAndLoadImage(event.target.result);\n        } else {\n          _this2.loadImageFailed.emit();\n        }\n      };\n\n      fileReader.readAsDataURL(file);\n    }\n    /**\n     * @param {?} type\n     * @return {?}\n     */\n\n  }, {\n    key: \"isValidImageType\",\n    value: function isValidImageType(type) {\n      return type === 'image/jpeg' || type === 'image/jpg' || type === 'image/png' || type === 'image/gif';\n    }\n    /**\n     * @param {?} imageBase64\n     * @return {?}\n     */\n\n  }, {\n    key: \"checkExifRotationAndLoadImage\",\n    value: function checkExifRotationAndLoadImage(imageBase64) {\n      var _this3 = this;\n\n      var\n      /** @type {?} */\n      exifRotation = ImageUtils.getOrientation(imageBase64);\n\n      if (exifRotation > 1) {\n        ImageUtils.resetOrientation(imageBase64, exifRotation, function (rotatedBase64) {\n          return _this3.loadBase64Image(rotatedBase64);\n        });\n      } else {\n        this.loadBase64Image(imageBase64);\n      }\n    }\n    /**\n     * @param {?} imageBase64\n     * @return {?}\n     */\n\n  }, {\n    key: \"loadBase64Image\",\n    value: function loadBase64Image(imageBase64) {\n      var _this4 = this;\n\n      this.originalImage = new Image();\n\n      this.originalImage.onload = function () {\n        _this4.originalSize.width = _this4.originalImage.width;\n        _this4.originalSize.height = _this4.originalImage.height;\n\n        _this4.cd.markForCheck();\n      };\n\n      this.safeImgDataUrl = this.sanitizer.bypassSecurityTrustResourceUrl(imageBase64);\n      this.originalImage.src = imageBase64;\n    }\n    /**\n     * @return {?}\n     */\n\n  }, {\n    key: \"imageLoadedInView\",\n    value: function imageLoadedInView() {\n      var _this5 = this;\n\n      if (this.originalImage != null) {\n        this.imageLoaded.emit();\n        setTimeout(function () {\n          _this5.setMaxSize();\n\n          _this5.resetCropperPosition();\n\n          _this5.cd.markForCheck();\n        });\n      }\n    }\n    /**\n     * @param {?} event\n     * @return {?}\n     */\n\n  }, {\n    key: \"onResize\",\n    value: function onResize(event) {\n      this.resizeCropperPosition();\n      this.setMaxSize();\n    }\n    /**\n     * @return {?}\n     */\n\n  }, {\n    key: \"resizeCropperPosition\",\n    value: function resizeCropperPosition() {\n      var\n      /** @type {?} */\n      displayedImage = this.elementRef.nativeElement.querySelector('.source-image');\n\n      if (this.maxSize.width !== displayedImage.offsetWidth || this.maxSize.height !== displayedImage.offsetHeight) {\n        this.cropper.x1 = this.cropper.x1 * displayedImage.offsetWidth / this.maxSize.width;\n        this.cropper.x2 = this.cropper.x2 * displayedImage.offsetWidth / this.maxSize.width;\n        this.cropper.y1 = this.cropper.y1 * displayedImage.offsetHeight / this.maxSize.height;\n        this.cropper.y2 = this.cropper.y2 * displayedImage.offsetHeight / this.maxSize.height;\n      }\n    }\n    /**\n     * @return {?}\n     */\n\n  }, {\n    key: \"resetCropperPosition\",\n    value: function resetCropperPosition() {\n      var\n      /** @type {?} */\n      displayedImage = this.elementRef.nativeElement.querySelector('.source-image');\n\n      if (displayedImage.offsetWidth / this.aspectRatio < displayedImage.offsetHeight) {\n        this.cropper.x1 = 0;\n        this.cropper.x2 = displayedImage.offsetWidth;\n        var\n        /** @type {?} */\n        cropperHeight = displayedImage.offsetWidth / this.aspectRatio;\n        this.cropper.y1 = (displayedImage.offsetHeight - cropperHeight) / 2;\n        this.cropper.y2 = this.cropper.y1 + cropperHeight;\n      } else {\n        this.cropper.y1 = 0;\n        this.cropper.y2 = displayedImage.offsetHeight;\n        var\n        /** @type {?} */\n        cropperWidth = displayedImage.offsetHeight * this.aspectRatio;\n        this.cropper.x1 = (displayedImage.offsetWidth - cropperWidth) / 2;\n        this.cropper.x2 = this.cropper.x1 + cropperWidth;\n      }\n\n      this.crop();\n      this.imageVisible = true;\n    }\n    /**\n     * @param {?} event\n     * @param {?} moveType\n     * @param {?=} position\n     * @return {?}\n     */\n\n  }, {\n    key: \"startMove\",\n    value: function startMove(event, moveType) {\n      var position = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      this.moveStart.active = true;\n      this.moveStart.type = moveType;\n      this.moveStart.position = position;\n      this.moveStart.clientX = this.getClientX(event);\n      this.moveStart.clientY = this.getClientY(event);\n      Object.assign(this.moveStart, this.cropper);\n      this.cd.markForCheck();\n    }\n    /**\n     * @param {?} event\n     * @return {?}\n     */\n\n  }, {\n    key: \"moveImg\",\n    value: function moveImg(event) {\n      if (this.moveStart.active) {\n        event.stopPropagation();\n        event.preventDefault();\n        this.setMaxSize();\n\n        if (this.moveStart.type === 'move') {\n          this.move(event);\n          this.checkCropperPosition(true);\n        } else if (this.moveStart.type === 'resize') {\n          this.resize(event);\n          this.checkCropperPosition(false);\n        }\n\n        this.cd.markForCheck();\n      }\n    }\n    /**\n     * @return {?}\n     */\n\n  }, {\n    key: \"setMaxSize\",\n    value: function setMaxSize() {\n      var\n      /** @type {?} */\n      el = this.elementRef.nativeElement.querySelector('.source-image');\n      this.maxSize.width = el.offsetWidth;\n      this.maxSize.height = el.offsetHeight;\n      this.marginLeft = this.sanitizer.bypassSecurityTrustStyle('calc(50% - ' + this.maxSize.width / 2 + 'px)');\n    }\n    /**\n     * @param {?=} maintainSize\n     * @return {?}\n     */\n\n  }, {\n    key: \"checkCropperPosition\",\n    value: function checkCropperPosition() {\n      var maintainSize = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      if (this.cropper.x1 < 0) {\n        this.cropper.x2 -= maintainSize ? this.cropper.x1 : 0;\n        this.cropper.x1 = 0;\n      }\n\n      if (this.cropper.y1 < 0) {\n        this.cropper.y2 -= maintainSize ? this.cropper.y1 : 0;\n        this.cropper.y1 = 0;\n      }\n\n      if (this.cropper.x2 > this.maxSize.width) {\n        this.cropper.x1 -= maintainSize ? this.cropper.x2 - this.maxSize.width : 0;\n        this.cropper.x2 = this.maxSize.width;\n      }\n\n      if (this.cropper.y2 > this.maxSize.height) {\n        this.cropper.y1 -= maintainSize ? this.cropper.y2 - this.maxSize.height : 0;\n        this.cropper.y2 = this.maxSize.height;\n      }\n    }\n    /**\n     * @param {?} event\n     * @return {?}\n     */\n\n  }, {\n    key: \"moveStop\",\n    value: function moveStop(event) {\n      if (this.moveStart.active) {\n        this.moveStart.active = false;\n        this.crop();\n        this.cd.markForCheck();\n      }\n    }\n    /**\n     * @param {?} event\n     * @return {?}\n     */\n\n  }, {\n    key: \"move\",\n    value: function move(event) {\n      var\n      /** @type {?} */\n      diffX = this.getClientX(event) - this.moveStart.clientX;\n      var\n      /** @type {?} */\n      diffY = this.getClientY(event) - this.moveStart.clientY;\n      this.cropper.x1 = this.moveStart.x1 + diffX;\n      this.cropper.y1 = this.moveStart.y1 + diffY;\n      this.cropper.x2 = this.moveStart.x2 + diffX;\n      this.cropper.y2 = this.moveStart.y2 + diffY;\n    }\n    /**\n     * @param {?} event\n     * @return {?}\n     */\n\n  }, {\n    key: \"resize\",\n    value: function resize(event) {\n      var\n      /** @type {?} */\n      diffX = this.getClientX(event) - this.moveStart.clientX;\n      var\n      /** @type {?} */\n      diffY = this.getClientY(event) - this.moveStart.clientY;\n\n      switch (this.moveStart.position) {\n        case 'left':\n          this.cropper.x1 = Math.min(this.moveStart.x1 + diffX, this.cropper.x2 - 20);\n          break;\n\n        case 'topleft':\n          this.cropper.x1 = Math.min(this.moveStart.x1 + diffX, this.cropper.x2 - 20);\n          this.cropper.y1 = Math.min(this.moveStart.y1 + diffY, this.cropper.y2 - 20);\n          break;\n\n        case 'top':\n          this.cropper.y1 = Math.min(this.moveStart.y1 + diffY, this.cropper.y2 - 20);\n          break;\n\n        case 'topright':\n          this.cropper.x2 = Math.max(this.moveStart.x2 + diffX, this.cropper.x1 + 20);\n          this.cropper.y1 = Math.min(this.moveStart.y1 + diffY, this.cropper.y2 - 20);\n          break;\n\n        case 'right':\n          this.cropper.x2 = Math.max(this.moveStart.x2 + diffX, this.cropper.x1 + 20);\n          break;\n\n        case 'bottomright':\n          this.cropper.x2 = Math.max(this.moveStart.x2 + diffX, this.cropper.x1 + 20);\n          this.cropper.y2 = Math.max(this.moveStart.y2 + diffY, this.cropper.y1 + 20);\n          break;\n\n        case 'bottom':\n          this.cropper.y2 = Math.max(this.moveStart.y2 + diffY, this.cropper.y1 + 20);\n          break;\n\n        case 'bottomleft':\n          this.cropper.x1 = Math.min(this.moveStart.x1 + diffX, this.cropper.x2 - 20);\n          this.cropper.y2 = Math.max(this.moveStart.y2 + diffY, this.cropper.y1 + 20);\n          break;\n      }\n\n      if (this.maintainAspectRatio) {\n        this.checkAspectRatio();\n      }\n    }\n    /**\n     * @return {?}\n     */\n\n  }, {\n    key: \"checkAspectRatio\",\n    value: function checkAspectRatio() {\n      var\n      /** @type {?} */\n      overflowX = 0;\n      var\n      /** @type {?} */\n      overflowY = 0;\n\n      switch (this.moveStart.position) {\n        case 'top':\n          this.cropper.x2 = this.cropper.x1 + (this.cropper.y2 - this.cropper.y1) * this.aspectRatio;\n          overflowX = Math.max(this.cropper.x2 - this.maxSize.width, 0);\n          overflowY = Math.max(0 - this.cropper.y1, 0);\n\n          if (overflowX > 0 || overflowY > 0) {\n            this.cropper.x2 -= overflowY * this.aspectRatio > overflowX ? overflowY * this.aspectRatio : overflowX;\n            this.cropper.y1 += overflowY * this.aspectRatio > overflowX ? overflowY : overflowX / this.aspectRatio;\n          }\n\n          break;\n\n        case 'bottom':\n          this.cropper.x2 = this.cropper.x1 + (this.cropper.y2 - this.cropper.y1) * this.aspectRatio;\n          overflowX = Math.max(this.cropper.x2 - this.maxSize.width, 0);\n          overflowY = Math.max(this.cropper.y2 - this.maxSize.height, 0);\n\n          if (overflowX > 0 || overflowY > 0) {\n            this.cropper.x2 -= overflowY * this.aspectRatio > overflowX ? overflowY * this.aspectRatio : overflowX;\n            this.cropper.y2 -= overflowY * this.aspectRatio > overflowX ? overflowY : overflowX / this.aspectRatio;\n          }\n\n          break;\n\n        case 'topleft':\n          this.cropper.y1 = this.cropper.y2 - (this.cropper.x2 - this.cropper.x1) / this.aspectRatio;\n          overflowX = Math.max(0 - this.cropper.x1, 0);\n          overflowY = Math.max(0 - this.cropper.y1, 0);\n\n          if (overflowX > 0 || overflowY > 0) {\n            this.cropper.x1 += overflowY * this.aspectRatio > overflowX ? overflowY * this.aspectRatio : overflowX;\n            this.cropper.y1 += overflowY * this.aspectRatio > overflowX ? overflowY : overflowX / this.aspectRatio;\n          }\n\n          break;\n\n        case 'topright':\n          this.cropper.y1 = this.cropper.y2 - (this.cropper.x2 - this.cropper.x1) / this.aspectRatio;\n          overflowX = Math.max(this.cropper.x2 - this.maxSize.width, 0);\n          overflowY = Math.max(0 - this.cropper.y1, 0);\n\n          if (overflowX > 0 || overflowY > 0) {\n            this.cropper.x2 -= overflowY * this.aspectRatio > overflowX ? overflowY * this.aspectRatio : overflowX;\n            this.cropper.y1 += overflowY * this.aspectRatio > overflowX ? overflowY : overflowX / this.aspectRatio;\n          }\n\n          break;\n\n        case 'right':\n        case 'bottomright':\n          this.cropper.y2 = this.cropper.y1 + (this.cropper.x2 - this.cropper.x1) / this.aspectRatio;\n          overflowX = Math.max(this.cropper.x2 - this.maxSize.width, 0);\n          overflowY = Math.max(this.cropper.y2 - this.maxSize.height, 0);\n\n          if (overflowX > 0 || overflowY > 0) {\n            this.cropper.x2 -= overflowY * this.aspectRatio > overflowX ? overflowY * this.aspectRatio : overflowX;\n            this.cropper.y2 -= overflowY * this.aspectRatio > overflowX ? overflowY : overflowX / this.aspectRatio;\n          }\n\n          break;\n\n        case 'left':\n        case 'bottomleft':\n          this.cropper.y2 = this.cropper.y1 + (this.cropper.x2 - this.cropper.x1) / this.aspectRatio;\n          overflowX = Math.max(0 - this.cropper.x1, 0);\n          overflowY = Math.max(this.cropper.y2 - this.maxSize.height, 0);\n\n          if (overflowX > 0 || overflowY > 0) {\n            this.cropper.x1 += overflowY * this.aspectRatio > overflowX ? overflowY * this.aspectRatio : overflowX;\n            this.cropper.y2 -= overflowY * this.aspectRatio > overflowX ? overflowY : overflowX / this.aspectRatio;\n          }\n\n          break;\n      }\n    }\n    /**\n     * @return {?}\n     */\n\n  }, {\n    key: \"crop\",\n    value: function crop() {\n      var\n      /** @type {?} */\n      displayedImage = this.elementRef.nativeElement.querySelector('.source-image');\n\n      if (displayedImage && this.originalImage != null) {\n        var\n        /** @type {?} */\n        ratio = this.originalSize.width / displayedImage.offsetWidth;\n        var\n        /** @type {?} */\n        left = Math.round(this.cropper.x1 * ratio);\n        var\n        /** @type {?} */\n        top = Math.round(this.cropper.y1 * ratio);\n        var\n        /** @type {?} */\n        width = Math.round((this.cropper.x2 - this.cropper.x1) * ratio);\n        var\n        /** @type {?} */\n        height = Math.round((this.cropper.y2 - this.cropper.y1) * ratio);\n        var\n        /** @type {?} */\n        resizeRatio = this.getResizeRatio(width);\n        var\n        /** @type {?} */\n        cropCanvas = document.createElement('canvas');\n        cropCanvas.width = width * resizeRatio;\n        cropCanvas.height = height * resizeRatio;\n        var\n        /** @type {?} */\n        ctx = cropCanvas.getContext('2d');\n\n        if (ctx) {\n          ctx.drawImage(this.originalImage, left, top, width, height, 0, 0, width * resizeRatio, height * resizeRatio);\n          var\n          /** @type {?} */\n          quality = Math.min(1, Math.max(0, this.imageQuality / 100));\n          var\n          /** @type {?} */\n          croppedImage = cropCanvas.toDataURL('image/' + this.format, quality);\n\n          if (croppedImage.length > 10) {\n            this.imageCropped.emit(croppedImage);\n          }\n        }\n      }\n    }\n    /**\n     * @param {?} width\n     * @return {?}\n     */\n\n  }, {\n    key: \"getResizeRatio\",\n    value: function getResizeRatio(width) {\n      return this.resizeToWidth > 0 && (!this.onlyScaleDown || width > this.resizeToWidth) ? this.resizeToWidth / width : 1;\n    }\n    /**\n     * @param {?} event\n     * @return {?}\n     */\n\n  }, {\n    key: \"getClientX\",\n    value: function getClientX(event) {\n      return event.clientX != null ? event.clientX : event.touches[0].clientX;\n    }\n    /**\n     * @param {?} event\n     * @return {?}\n     */\n\n  }, {\n    key: \"getClientY\",\n    value: function getClientY(event) {\n      return event.clientY != null ? event.clientY : event.touches[0].clientY;\n    }\n  }]);\n\n  return ImageCropperComponent;\n}();\n\nImageCropperComponent.ɵfac = function ImageCropperComponent_Factory(t) {\n  return new (t || ImageCropperComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.DomSanitizer), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef));\n};\n\nImageCropperComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({\n  type: ImageCropperComponent,\n  selectors: [[\"image-cropper\"]],\n  hostBindings: function ImageCropperComponent_HostBindings(rf, ctx) {\n    if (rf & 1) {\n      ɵngcc0.ɵɵlistener(\"resize\", function ImageCropperComponent_resize_HostBindingHandler($event) {\n        return ctx.onResize($event);\n      }, false, ɵngcc0.ɵɵresolveWindow)(\"mousemove\", function ImageCropperComponent_mousemove_HostBindingHandler($event) {\n        return ctx.moveImg($event);\n      }, false, ɵngcc0.ɵɵresolveDocument)(\"touchmove\", function ImageCropperComponent_touchmove_HostBindingHandler($event) {\n        return ctx.moveImg($event);\n      }, false, ɵngcc0.ɵɵresolveDocument)(\"mouseup\", function ImageCropperComponent_mouseup_HostBindingHandler($event) {\n        return ctx.moveStop($event);\n      }, false, ɵngcc0.ɵɵresolveDocument)(\"touchend\", function ImageCropperComponent_touchend_HostBindingHandler($event) {\n        return ctx.moveStop($event);\n      }, false, ɵngcc0.ɵɵresolveDocument);\n    }\n  },\n  inputs: {\n    format: \"format\",\n    maintainAspectRatio: \"maintainAspectRatio\",\n    aspectRatio: \"aspectRatio\",\n    resizeToWidth: \"resizeToWidth\",\n    onlyScaleDown: \"onlyScaleDown\",\n    imageQuality: \"imageQuality\",\n    cropper: \"cropper\",\n    imageFileChanged: \"imageFileChanged\",\n    imageChangedEvent: \"imageChangedEvent\",\n    imageBase64: \"imageBase64\"\n  },\n  outputs: {\n    imageCropped: \"imageCropped\",\n    imageLoaded: \"imageLoaded\",\n    loadImageFailed: \"loadImageFailed\"\n  },\n  features: [ɵngcc0.ɵɵNgOnChangesFeature],\n  decls: 25,\n  vars: 15,\n  consts: [[1, \"source-image\", 3, \"src\", \"load\"], [1, \"cropper\"], [1, \"move\", 3, \"mousedown\", \"touchstart\"], [1, \"resize\", \"topleft\", 3, \"mousedown\", \"touchstart\"], [1, \"square\"], [1, \"resize\", \"top\"], [1, \"resize\", \"topright\", 3, \"mousedown\", \"touchstart\"], [1, \"resize\", \"right\"], [1, \"resize\", \"bottomright\", 3, \"mousedown\", \"touchstart\"], [1, \"resize\", \"bottom\"], [1, \"resize\", \"bottomleft\", 3, \"mousedown\", \"touchstart\"], [1, \"resize\", \"left\"], [1, \"resize-bar\", \"top\", 3, \"mousedown\", \"touchstart\"], [1, \"resize-bar\", \"right\", 3, \"mousedown\", \"touchstart\"], [1, \"resize-bar\", \"bottom\", 3, \"mousedown\", \"touchstart\"], [1, \"resize-bar\", \"left\", 3, \"mousedown\", \"touchstart\"]],\n  template: function ImageCropperComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      ɵngcc0.ɵɵelementStart(0, \"div\");\n      ɵngcc0.ɵɵelementStart(1, \"img\", 0);\n      ɵngcc0.ɵɵlistener(\"load\", function ImageCropperComponent_Template_img_load_1_listener() {\n        return ctx.imageLoadedInView();\n      });\n      ɵngcc0.ɵɵelementEnd();\n      ɵngcc0.ɵɵelementStart(2, \"div\", 1);\n      ɵngcc0.ɵɵelementStart(3, \"div\", 2);\n      ɵngcc0.ɵɵlistener(\"mousedown\", function ImageCropperComponent_Template_div_mousedown_3_listener($event) {\n        return ctx.startMove($event, \"move\");\n      })(\"touchstart\", function ImageCropperComponent_Template_div_touchstart_3_listener($event) {\n        return ctx.startMove($event, \"move\");\n      });\n      ɵngcc0.ɵɵtext(4, \"\\xA0\");\n      ɵngcc0.ɵɵelementEnd();\n      ɵngcc0.ɵɵelementStart(5, \"span\", 3);\n      ɵngcc0.ɵɵlistener(\"mousedown\", function ImageCropperComponent_Template_span_mousedown_5_listener($event) {\n        return ctx.startMove($event, \"resize\", \"topleft\");\n      })(\"touchstart\", function ImageCropperComponent_Template_span_touchstart_5_listener($event) {\n        return ctx.startMove($event, \"resize\", \"topleft\");\n      });\n      ɵngcc0.ɵɵelement(6, \"span\", 4);\n      ɵngcc0.ɵɵelementEnd();\n      ɵngcc0.ɵɵelementStart(7, \"span\", 5);\n      ɵngcc0.ɵɵelement(8, \"span\", 4);\n      ɵngcc0.ɵɵelementEnd();\n      ɵngcc0.ɵɵelementStart(9, \"span\", 6);\n      ɵngcc0.ɵɵlistener(\"mousedown\", function ImageCropperComponent_Template_span_mousedown_9_listener($event) {\n        return ctx.startMove($event, \"resize\", \"topright\");\n      })(\"touchstart\", function ImageCropperComponent_Template_span_touchstart_9_listener($event) {\n        return ctx.startMove($event, \"resize\", \"topright\");\n      });\n      ɵngcc0.ɵɵelement(10, \"span\", 4);\n      ɵngcc0.ɵɵelementEnd();\n      ɵngcc0.ɵɵelementStart(11, \"span\", 7);\n      ɵngcc0.ɵɵelement(12, \"span\", 4);\n      ɵngcc0.ɵɵelementEnd();\n      ɵngcc0.ɵɵelementStart(13, \"span\", 8);\n      ɵngcc0.ɵɵlistener(\"mousedown\", function ImageCropperComponent_Template_span_mousedown_13_listener($event) {\n        return ctx.startMove($event, \"resize\", \"bottomright\");\n      })(\"touchstart\", function ImageCropperComponent_Template_span_touchstart_13_listener($event) {\n        return ctx.startMove($event, \"resize\", \"bottomright\");\n      });\n      ɵngcc0.ɵɵelement(14, \"span\", 4);\n      ɵngcc0.ɵɵelementEnd();\n      ɵngcc0.ɵɵelementStart(15, \"span\", 9);\n      ɵngcc0.ɵɵelement(16, \"span\", 4);\n      ɵngcc0.ɵɵelementEnd();\n      ɵngcc0.ɵɵelementStart(17, \"span\", 10);\n      ɵngcc0.ɵɵlistener(\"mousedown\", function ImageCropperComponent_Template_span_mousedown_17_listener($event) {\n        return ctx.startMove($event, \"resize\", \"bottomleft\");\n      })(\"touchstart\", function ImageCropperComponent_Template_span_touchstart_17_listener($event) {\n        return ctx.startMove($event, \"resize\", \"bottomleft\");\n      });\n      ɵngcc0.ɵɵelement(18, \"span\", 4);\n      ɵngcc0.ɵɵelementEnd();\n      ɵngcc0.ɵɵelementStart(19, \"span\", 11);\n      ɵngcc0.ɵɵelement(20, \"span\", 4);\n      ɵngcc0.ɵɵelementEnd();\n      ɵngcc0.ɵɵelementStart(21, \"span\", 12);\n      ɵngcc0.ɵɵlistener(\"mousedown\", function ImageCropperComponent_Template_span_mousedown_21_listener($event) {\n        return ctx.startMove($event, \"resize\", \"top\");\n      })(\"touchstart\", function ImageCropperComponent_Template_span_touchstart_21_listener($event) {\n        return ctx.startMove($event, \"resize\", \"top\");\n      });\n      ɵngcc0.ɵɵelementEnd();\n      ɵngcc0.ɵɵelementStart(22, \"span\", 13);\n      ɵngcc0.ɵɵlistener(\"mousedown\", function ImageCropperComponent_Template_span_mousedown_22_listener($event) {\n        return ctx.startMove($event, \"resize\", \"right\");\n      })(\"touchstart\", function ImageCropperComponent_Template_span_touchstart_22_listener($event) {\n        return ctx.startMove($event, \"resize\", \"right\");\n      });\n      ɵngcc0.ɵɵelementEnd();\n      ɵngcc0.ɵɵelementStart(23, \"span\", 14);\n      ɵngcc0.ɵɵlistener(\"mousedown\", function ImageCropperComponent_Template_span_mousedown_23_listener($event) {\n        return ctx.startMove($event, \"resize\", \"bottom\");\n      })(\"touchstart\", function ImageCropperComponent_Template_span_touchstart_23_listener($event) {\n        return ctx.startMove($event, \"resize\", \"bottom\");\n      });\n      ɵngcc0.ɵɵelementEnd();\n      ɵngcc0.ɵɵelementStart(24, \"span\", 15);\n      ɵngcc0.ɵɵlistener(\"mousedown\", function ImageCropperComponent_Template_span_mousedown_24_listener($event) {\n        return ctx.startMove($event, \"resize\", \"left\");\n      })(\"touchstart\", function ImageCropperComponent_Template_span_touchstart_24_listener($event) {\n        return ctx.startMove($event, \"resize\", \"left\");\n      });\n      ɵngcc0.ɵɵelementEnd();\n      ɵngcc0.ɵɵelementEnd();\n      ɵngcc0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      ɵngcc0.ɵɵadvance(1);\n      ɵngcc0.ɵɵstyleProp(\"visibility\", ctx.imageVisible ? \"visible\" : \"hidden\");\n      ɵngcc0.ɵɵproperty(\"src\", ctx.safeImgDataUrl, ɵngcc0.ɵɵsanitizeUrl);\n      ɵngcc0.ɵɵadvance(1);\n      ɵngcc0.ɵɵstyleProp(\"top\", ctx.cropper.y1, \"px\")(\"left\", ctx.cropper.x1, \"px\")(\"width\", ctx.cropper.x2 - ctx.cropper.x1, \"px\")(\"height\", ctx.cropper.y2 - ctx.cropper.y1, \"px\")(\"margin-left\", ctx.marginLeft)(\"visibility\", ctx.imageVisible ? \"visible\" : \"hidden\");\n    }\n  },\n  styles: [\"[_nghost-%COMP%] {\\n        display: -webkit-box;\\n        display: -ms-flexbox;\\n        display: flex;\\n        position: relative;\\n        width: 100%;\\n        max-width: 100%;\\n        max-height: 100%;\\n        overflow: hidden;\\n        padding: 5px;\\n        text-align: center;\\n        -webkit-user-select: none;\\n        -moz-user-select: none;\\n        -ms-user-select: none;\\n        user-select: none; }\\n        [_nghost-%COMP%]    > div[_ngcontent-%COMP%] {\\n          position: relative;\\n          width: 100%; }\\n          [_nghost-%COMP%]    > div[_ngcontent-%COMP%]   .source-image[_ngcontent-%COMP%] {\\n            max-width: 100%;\\n            max-height: 100%; }\\n        [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%] {\\n          position: absolute;\\n          display: -webkit-box;\\n          display: -ms-flexbox;\\n          display: flex;\\n          color: #53535C !important;\\n          background: transparent !important;\\n          outline-color: rgba(255, 255, 255, 0.3);\\n          outline-width: 1000px;\\n          outline-style: solid;\\n          -ms-touch-action: none;\\n              touch-action: none; }\\n          [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]:after {\\n            position: absolute;\\n            content: '';\\n            top: 0;\\n            bottom: 0;\\n            left: 0;\\n            right: 0;\\n            pointer-events: none;\\n            border: dashed 1px;\\n            opacity: .75;\\n            color: inherit;\\n            z-index: 1; }\\n          [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .move[_ngcontent-%COMP%] {\\n            width: 100%;\\n            cursor: move;\\n            border: 1px solid rgba(255, 255, 255, 0.5); }\\n          [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%] {\\n            position: absolute;\\n            display: inline-block;\\n            line-height: 6px;\\n            padding: 8px;\\n            opacity: .85;\\n            z-index: 1; }\\n            [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize[_ngcontent-%COMP%]   .square[_ngcontent-%COMP%] {\\n              display: inline-block;\\n              background: #53535C !important;\\n              width: 6px;\\n              height: 6px;\\n              border: 1px solid rgba(255, 255, 255, 0.5); }\\n            [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.topleft[_ngcontent-%COMP%] {\\n              top: -12px;\\n              left: -12px;\\n              cursor: nw-resize; }\\n            [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.top[_ngcontent-%COMP%] {\\n              top: -12px;\\n              left: calc(50% - 12px);\\n              cursor: n-resize; }\\n            [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.topright[_ngcontent-%COMP%] {\\n              top: -12px;\\n              right: -12px;\\n              cursor: ne-resize; }\\n            [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.right[_ngcontent-%COMP%] {\\n              top: calc(50% - 12px);\\n              right: -12px;\\n              cursor: e-resize; }\\n            [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottomright[_ngcontent-%COMP%] {\\n              bottom: -12px;\\n              right: -12px;\\n              cursor: se-resize; }\\n            [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottom[_ngcontent-%COMP%] {\\n              bottom: -12px;\\n              left: calc(50% - 12px);\\n              cursor: s-resize; }\\n            [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.bottomleft[_ngcontent-%COMP%] {\\n              bottom: -12px;\\n              left: -12px;\\n              cursor: sw-resize; }\\n            [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize.left[_ngcontent-%COMP%] {\\n              top: calc(50% - 12px);\\n              left: -12px;\\n              cursor: w-resize; }\\n          [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar[_ngcontent-%COMP%] {\\n            position: absolute;\\n            z-index: 1; }\\n            [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.top[_ngcontent-%COMP%] {\\n              top: -11px;\\n              left: 11px;\\n              width: calc(100% - 22px);\\n              height: 22px;\\n              cursor: n-resize; }\\n            [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.right[_ngcontent-%COMP%] {\\n              top: 11px;\\n              right: -11px;\\n              height: calc(100% - 22px);\\n              width: 22px;\\n              cursor: e-resize; }\\n            [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.bottom[_ngcontent-%COMP%] {\\n              bottom: -11px;\\n              left: 11px;\\n              width: calc(100% - 22px);\\n              height: 22px;\\n              cursor: s-resize; }\\n            [_nghost-%COMP%]   .cropper[_ngcontent-%COMP%]   .resize-bar.left[_ngcontent-%COMP%] {\\n              top: 11px;\\n              left: -11px;\\n              height: calc(100% - 22px);\\n              width: 22px;\\n              cursor: w-resize; }\"],\n  changeDetection: 0\n});\n/**\n * @nocollapse\n */\n\nImageCropperComponent.ctorParameters = function () {\n  return [{\n    type: ElementRef\n  }, {\n    type: DomSanitizer\n  }, {\n    type: ChangeDetectorRef\n  }];\n};\n\nImageCropperComponent.propDecorators = {\n  'imageFileChanged': [{\n    type: Input\n  }],\n  'imageChangedEvent': [{\n    type: Input\n  }],\n  'imageBase64': [{\n    type: Input\n  }],\n  'format': [{\n    type: Input\n  }],\n  'maintainAspectRatio': [{\n    type: Input\n  }],\n  'aspectRatio': [{\n    type: Input\n  }],\n  'resizeToWidth': [{\n    type: Input\n  }],\n  'onlyScaleDown': [{\n    type: Input\n  }],\n  'imageQuality': [{\n    type: Input\n  }],\n  'cropper': [{\n    type: Input\n  }],\n  'imageCropped': [{\n    type: Output\n  }],\n  'imageLoaded': [{\n    type: Output\n  }],\n  'loadImageFailed': [{\n    type: Output\n  }],\n  'onResize': [{\n    type: HostListener,\n    args: ['window:resize', ['$event']]\n  }],\n  'moveImg': [{\n    type: HostListener,\n    args: ['document:mousemove', ['$event']]\n  }, {\n    type: HostListener,\n    args: ['document:touchmove', ['$event']]\n  }],\n  'moveStop': [{\n    type: HostListener,\n    args: ['document:mouseup', ['$event']]\n  }, {\n    type: HostListener,\n    args: ['document:touchend', ['$event']]\n  }]\n};\n/*@__PURE__*/\n\n(function () {\n  ɵngcc0.ɵsetClassMetadata(ImageCropperComponent, [{\n    type: Component,\n    args: [{\n      selector: 'image-cropper',\n      template: \"\\n      <div>\\n          <img\\n              [src]=\\\"safeImgDataUrl\\\"\\n              [style.visibility]=\\\"imageVisible ? 'visible' : 'hidden'\\\"\\n              (load)=\\\"imageLoadedInView()\\\"\\n              class=\\\"source-image\\\"\\n          />\\n          <div class=\\\"cropper\\\"\\n               [style.top.px]=\\\"cropper.y1\\\"\\n               [style.left.px]=\\\"cropper.x1\\\"\\n               [style.width.px]=\\\"cropper.x2 - cropper.x1\\\"\\n               [style.height.px]=\\\"cropper.y2 - cropper.y1\\\"\\n               [style.margin-left]=\\\"marginLeft\\\"\\n               [style.visibility]=\\\"imageVisible ? 'visible' : 'hidden'\\\"\\n          >\\n              <div\\n                  (mousedown)=\\\"startMove($event, 'move')\\\"\\n                  (touchstart)=\\\"startMove($event, 'move')\\\"\\n                  class=\\\"move\\\"\\n              >&nbsp;</div>\\n              <span\\n                  class=\\\"resize topleft\\\"\\n                  (mousedown)=\\\"startMove($event, 'resize', 'topleft')\\\"\\n                  (touchstart)=\\\"startMove($event, 'resize', 'topleft')\\\"\\n              ><span class=\\\"square\\\"></span></span>\\n              <span\\n                  class=\\\"resize top\\\"\\n              ><span class=\\\"square\\\"></span></span>\\n              <span\\n                  class=\\\"resize topright\\\"\\n                  (mousedown)=\\\"startMove($event, 'resize', 'topright')\\\"\\n                  (touchstart)=\\\"startMove($event, 'resize', 'topright')\\\"\\n              ><span class=\\\"square\\\"></span></span>\\n              <span\\n                  class=\\\"resize right\\\"\\n              ><span class=\\\"square\\\"></span></span>\\n              <span\\n                  class=\\\"resize bottomright\\\"\\n                  (mousedown)=\\\"startMove($event, 'resize', 'bottomright')\\\"\\n                  (touchstart)=\\\"startMove($event, 'resize', 'bottomright')\\\"\\n              ><span class=\\\"square\\\"></span></span>\\n              <span\\n                  class=\\\"resize bottom\\\"\\n              ><span class=\\\"square\\\"></span></span>\\n              <span\\n                  class=\\\"resize bottomleft\\\"\\n                  (mousedown)=\\\"startMove($event, 'resize', 'bottomleft')\\\"\\n                  (touchstart)=\\\"startMove($event, 'resize', 'bottomleft')\\\"\\n              ><span class=\\\"square\\\"></span></span>\\n              <span\\n                  class=\\\"resize left\\\"\\n              ><span class=\\\"square\\\"></span></span>\\n              <span\\n                  class=\\\"resize-bar top\\\"\\n                  (mousedown)=\\\"startMove($event, 'resize', 'top')\\\"\\n                  (touchstart)=\\\"startMove($event, 'resize', 'top')\\\"\\n              ></span>\\n              <span\\n                  class=\\\"resize-bar right\\\"\\n                  (mousedown)=\\\"startMove($event, 'resize', 'right')\\\"\\n                  (touchstart)=\\\"startMove($event, 'resize', 'right')\\\"\\n              ></span>\\n              <span\\n                  class=\\\"resize-bar bottom\\\"\\n                  (mousedown)=\\\"startMove($event, 'resize', 'bottom')\\\"\\n                  (touchstart)=\\\"startMove($event, 'resize', 'bottom')\\\"\\n              ></span>\\n              <span\\n                  class=\\\"resize-bar left\\\"\\n                  (mousedown)=\\\"startMove($event, 'resize', 'left')\\\"\\n                  (touchstart)=\\\"startMove($event, 'resize', 'left')\\\"\\n              ></span>\\n          </div>\\n      </div>\\n    \",\n      styles: [\"\\n      :host {\\n        display: -webkit-box;\\n        display: -ms-flexbox;\\n        display: flex;\\n        position: relative;\\n        width: 100%;\\n        max-width: 100%;\\n        max-height: 100%;\\n        overflow: hidden;\\n        padding: 5px;\\n        text-align: center;\\n        -webkit-user-select: none;\\n        -moz-user-select: none;\\n        -ms-user-select: none;\\n        user-select: none; }\\n        :host > div {\\n          position: relative;\\n          width: 100%; }\\n          :host > div .source-image {\\n            max-width: 100%;\\n            max-height: 100%; }\\n        :host .cropper {\\n          position: absolute;\\n          display: -webkit-box;\\n          display: -ms-flexbox;\\n          display: flex;\\n          color: #53535C !important;\\n          background: transparent !important;\\n          outline-color: rgba(255, 255, 255, 0.3);\\n          outline-width: 1000px;\\n          outline-style: solid;\\n          -ms-touch-action: none;\\n              touch-action: none; }\\n          :host .cropper:after {\\n            position: absolute;\\n            content: '';\\n            top: 0;\\n            bottom: 0;\\n            left: 0;\\n            right: 0;\\n            pointer-events: none;\\n            border: dashed 1px;\\n            opacity: .75;\\n            color: inherit;\\n            z-index: 1; }\\n          :host .cropper .move {\\n            width: 100%;\\n            cursor: move;\\n            border: 1px solid rgba(255, 255, 255, 0.5); }\\n          :host .cropper .resize {\\n            position: absolute;\\n            display: inline-block;\\n            line-height: 6px;\\n            padding: 8px;\\n            opacity: .85;\\n            z-index: 1; }\\n            :host .cropper .resize .square {\\n              display: inline-block;\\n              background: #53535C !important;\\n              width: 6px;\\n              height: 6px;\\n              border: 1px solid rgba(255, 255, 255, 0.5); }\\n            :host .cropper .resize.topleft {\\n              top: -12px;\\n              left: -12px;\\n              cursor: nw-resize; }\\n            :host .cropper .resize.top {\\n              top: -12px;\\n              left: calc(50% - 12px);\\n              cursor: n-resize; }\\n            :host .cropper .resize.topright {\\n              top: -12px;\\n              right: -12px;\\n              cursor: ne-resize; }\\n            :host .cropper .resize.right {\\n              top: calc(50% - 12px);\\n              right: -12px;\\n              cursor: e-resize; }\\n            :host .cropper .resize.bottomright {\\n              bottom: -12px;\\n              right: -12px;\\n              cursor: se-resize; }\\n            :host .cropper .resize.bottom {\\n              bottom: -12px;\\n              left: calc(50% - 12px);\\n              cursor: s-resize; }\\n            :host .cropper .resize.bottomleft {\\n              bottom: -12px;\\n              left: -12px;\\n              cursor: sw-resize; }\\n            :host .cropper .resize.left {\\n              top: calc(50% - 12px);\\n              left: -12px;\\n              cursor: w-resize; }\\n          :host .cropper .resize-bar {\\n            position: absolute;\\n            z-index: 1; }\\n            :host .cropper .resize-bar.top {\\n              top: -11px;\\n              left: 11px;\\n              width: calc(100% - 22px);\\n              height: 22px;\\n              cursor: n-resize; }\\n            :host .cropper .resize-bar.right {\\n              top: 11px;\\n              right: -11px;\\n              height: calc(100% - 22px);\\n              width: 22px;\\n              cursor: e-resize; }\\n            :host .cropper .resize-bar.bottom {\\n              bottom: -11px;\\n              left: 11px;\\n              width: calc(100% - 22px);\\n              height: 22px;\\n              cursor: s-resize; }\\n            :host .cropper .resize-bar.left {\\n              top: 11px;\\n              left: -11px;\\n              height: calc(100% - 22px);\\n              width: 22px;\\n              cursor: w-resize; }\\n    \"],\n      changeDetection: ChangeDetectionStrategy.OnPush\n    }]\n  }], function () {\n    return [{\n      type: ɵngcc0.ElementRef\n    }, {\n      type: ɵngcc1.DomSanitizer\n    }, {\n      type: ɵngcc0.ChangeDetectorRef\n    }];\n  }, {\n    format: [{\n      type: Input\n    }],\n    maintainAspectRatio: [{\n      type: Input\n    }],\n    aspectRatio: [{\n      type: Input\n    }],\n    resizeToWidth: [{\n      type: Input\n    }],\n    onlyScaleDown: [{\n      type: Input\n    }],\n    imageQuality: [{\n      type: Input\n    }],\n    cropper: [{\n      type: Input\n    }],\n    imageCropped: [{\n      type: Output\n    }],\n    imageLoaded: [{\n      type: Output\n    }],\n    loadImageFailed: [{\n      type: Output\n    }],\n    imageFileChanged: [{\n      type: Input\n    }],\n    imageChangedEvent: [{\n      type: Input\n    }],\n    imageBase64: [{\n      type: Input\n    }],\n\n    /**\n     * @param {?} event\n     * @return {?}\n     */\n    onResize: [{\n      type: HostListener,\n      args: ['window:resize', ['$event']]\n    }],\n\n    /**\n     * @param {?} event\n     * @return {?}\n     */\n    moveImg: [{\n      type: HostListener,\n      args: ['document:mousemove', ['$event']]\n    }, {\n      type: HostListener,\n      args: ['document:touchmove', ['$event']]\n    }],\n\n    /**\n     * @param {?} event\n     * @return {?}\n     */\n    moveStop: [{\n      type: HostListener,\n      args: ['document:mouseup', ['$event']]\n    }, {\n      type: HostListener,\n      args: ['document:touchend', ['$event']]\n    }]\n  });\n})();\n\nvar ImageCropperModule = function ImageCropperModule() {\n  _classCallCheck(this, ImageCropperModule);\n};\n\nImageCropperModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({\n  type: ImageCropperModule\n});\nImageCropperModule.ɵinj = ɵngcc0.ɵɵdefineInjector({\n  factory: function ImageCropperModule_Factory(t) {\n    return new (t || ImageCropperModule)();\n  },\n  imports: [[CommonModule]]\n});\n/**\n * @nocollapse\n */\n\nImageCropperModule.ctorParameters = function () {\n  return [];\n};\n\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(ImageCropperModule, {\n    declarations: function declarations() {\n      return [ImageCropperComponent];\n    },\n    imports: function imports() {\n      return [CommonModule];\n    },\n    exports: function exports() {\n      return [ImageCropperComponent];\n    }\n  });\n})();\n/*@__PURE__*/\n\n\n(function () {\n  ɵngcc0.ɵsetClassMetadata(ImageCropperModule, [{\n    type: NgModule,\n    args: [{\n      imports: [CommonModule],\n      declarations: [ImageCropperComponent],\n      exports: [ImageCropperComponent]\n    }]\n  }], null, null);\n})();\n/**\n * Generated bundle index. Do not edit.\n */\n\n\nexport { ImageCropperModule, ImageCropperComponent };","map":{"version":3,"sources":["ts/src/image.utils.ts","ts/src/image-cropper.component.ts","ts/src/image-cropper.module.ts","ts/ngx-image-cropper.ts"],"names":[],"mappings":"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","sourcesContent":["\nexport class ImageUtils {\n/**\n * @param {?} imageBase64\n * @return {?}\n */\nstatic getOrientation(imageBase64: string): number {\n        const /** @type {?} */ view = new DataView(this.base64ToArrayBuffer(imageBase64));\n        if (view.getUint16(0, false) != 0xFFD8) {\n            return -2;\n        }\n        const /** @type {?} */ length = view.byteLength;\n        let /** @type {?} */ offset = 2;\n        while (offset < length) {\n            if (view.getUint16(offset + 2, false) <= 8) return -1;\n            const /** @type {?} */ marker = view.getUint16(offset, false);\n            offset += 2;\n            if (marker == 0xFFE1) {\n                if (view.getUint32(offset += 2, false) != 0x45786966) {\n                    return -1;\n                }\n\n                const /** @type {?} */ little = view.getUint16(offset += 6, false) == 0x4949;\n                offset += view.getUint32(offset + 4, little);\n                const /** @type {?} */ tags = view.getUint16(offset, little);\n                offset += 2;\n                for (let /** @type {?} */ i = 0; i < tags; i++) {\n                    if (view.getUint16(offset + (i * 12), little) == 0x0112) {\n                        return view.getUint16(offset + (i * 12) + 8, little);\n                    }\n                }\n            }\n            else if ((marker & 0xFF00) != 0xFF00) {\n                break;\n            }\n            else {\n                offset += view.getUint16(offset, false);\n            }\n        }\n        return -1;\n    }\n/**\n * @param {?} imageBase64\n * @return {?}\n */\nprivate static base64ToArrayBuffer(imageBase64: string) {\n        imageBase64 = imageBase64.replace(/^data\\:([^\\;]+)\\;base64,/gmi, '');\n        const /** @type {?} */ binaryString = atob(imageBase64);\n        const /** @type {?} */ len = binaryString.length;\n        const /** @type {?} */ bytes = new Uint8Array(len);\n        for (let /** @type {?} */ i = 0; i < len; i++) {\n            bytes[i] = binaryString.charCodeAt(i);\n        }\n        return bytes.buffer;\n    }\n/**\n * @param {?} srcBase64\n * @param {?} srcOrientation\n * @param {?} callback\n * @return {?}\n */\nstatic resetOrientation(srcBase64: string, srcOrientation: number, callback: Function) {\n        const /** @type {?} */ img = new Image();\n        img.onload = function () {\n            const /** @type {?} */ width = img.width;\n            const /** @type {?} */ height = img.height;\n            const /** @type {?} */ canvas = document.createElement('canvas');\n            const /** @type {?} */ ctx = canvas.getContext('2d');\n\n            if (ctx) {\n                if (4 < srcOrientation && srcOrientation < 9) {\n                    canvas.width = height;\n                    canvas.height = width;\n                } else {\n                    canvas.width = width;\n                    canvas.height = height;\n                }\n                ImageUtils.transformCanvas(ctx, srcOrientation, width, height);\n                ctx.drawImage(img, 0, 0);\n                callback(canvas.toDataURL());\n            } else {\n                callback(srcBase64);\n            }\n        };\n        img.src = srcBase64;\n    }\n/**\n * @param {?} ctx\n * @param {?} orientation\n * @param {?} width\n * @param {?} height\n * @return {?}\n */\nprivate static transformCanvas(ctx: any, orientation: number, width: number, height: number) {\n        switch (orientation) {\n            case 2:\n                ctx.transform(-1, 0, 0, 1, width, 0);\n                break;\n            case 3:\n                ctx.transform(-1, 0, 0, -1, width, height);\n                break;\n            case 4:\n                ctx.transform(1, 0, 0, -1, 0, height);\n                break;\n            case 5:\n                ctx.transform(0, 1, 1, 0, 0, 0);\n                break;\n            case 6:\n                ctx.transform(0, 1, -1, 0, height, 0);\n                break;\n            case 7:\n                ctx.transform(0, -1, -1, 0, height, width);\n                break;\n            case 8:\n                ctx.transform(0, -1, 1, 0, 0, width);\n                break;\n            default:\n                break;\n        }\n    }\n}\n","import {\n    Component,\n    ElementRef,\n    EventEmitter,\n    HostListener,\n    Input,\n    OnChanges,\n    Output,\n    SimpleChanges,\n    ChangeDetectorRef,\n    ChangeDetectionStrategy\n} from '@angular/core';\nimport { DomSanitizer, SafeUrl, SafeStyle } from '@angular/platform-browser';\nimport { ImageUtils } from './image.utils';\n\ninterface MoveStart {\n    active: boolean;\n    type: string | null;\n    position: string | null;\n    x1: number;\n    y1: number;\n    x2: number;\n    y2: number;\n    clientX: number;\n    clientY: number;\n}\n\ninterface Dimensions {\n    width: number;\n    height: number;\n}\n\nexport interface CropperPosition {\n    x1: number;\n    y1: number;\n    x2: number;\n    y2: number;\n}\nexport class ImageCropperComponent implements OnChanges {\nprivate originalImage: any;\nprivate moveStart: MoveStart;\nprivate maxSize: Dimensions;\nprivate originalSize: Dimensions;\n\n    safeImgDataUrl: SafeUrl | string;\n    marginLeft: SafeStyle | string = '0px';\n    imageVisible = false;\n/**\n * @param {?} file\n * @return {?}\n */\nset imageFileChanged(file: File) {\n        this.initCropper();\n        if (file) {\n            this.loadImageFile(file);\n        }\n    }\n/**\n * @param {?} event\n * @return {?}\n */\nset imageChangedEvent(event: any) {\n        this.initCropper();\n        if (event && event.target && event.target.files && event.target.files.length > 0) {\n            this.loadImageFile(event.target.files[0]);\n        }\n    }\n/**\n * @param {?} imageBase64\n * @return {?}\n */\nset imageBase64(imageBase64: string) {\n        this.initCropper();\n        this.loadBase64Image(imageBase64);\n    }\n\n     format: 'png' | 'jpeg' | 'bmp' | 'webp' | 'ico' = 'png';\n     maintainAspectRatio = true;\n     aspectRatio = 1;\n     resizeToWidth = 0;\n     onlyScaleDown = false;\n     imageQuality = 92;\n     cropper: CropperPosition = {\n        x1: -100,\n        y1: -100,\n        x2: 10000,\n        y2: 10000\n    };\n\n     imageCropped = new EventEmitter<string>();\n     imageLoaded = new EventEmitter<void>();\n     loadImageFailed = new EventEmitter<void>();\n/**\n * @param {?} elementRef\n * @param {?} sanitizer\n * @param {?} cd\n */\nconstructor(private elementRef: ElementRef,\nprivate sanitizer: DomSanitizer,\nprivate cd: ChangeDetectorRef) {\n        this.initCropper();\n    }\n/**\n * @param {?} changes\n * @return {?}\n */\nngOnChanges(changes: SimpleChanges): void {\n        if (changes['cropper']) {\n            setTimeout(() => {\n                this.setMaxSize();\n                this.checkCropperPosition(false);\n                this.crop();\n                this.cd.markForCheck();\n            });\n        }\n    }\n/**\n * @return {?}\n */\nprivate initCropper() {\n        this.imageVisible = false;\n        this.originalImage = null;\n        this.safeImgDataUrl = 'data:image/png;base64,iVBORw0KGg'\n            + 'oAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAU'\n            + 'AAarVyFEAAAAASUVORK5CYII=';\n        this.moveStart = {\n            active: false,\n            type: null,\n            position: null,\n            x1: 0,\n            y1: 0,\n            x2: 0,\n            y2: 0,\n            clientX: 0,\n            clientY: 0\n        };\n        this.maxSize = {\n            width: 0,\n            height: 0\n        };\n        this.originalSize = {\n            width: 0,\n            height: 0\n        };\n        this.cropper.x1 = -100;\n        this.cropper.y1 = -100;\n        this.cropper.x2 = 10000;\n        this.cropper.y2 = 10000;\n    }\n/**\n * @param {?} file\n * @return {?}\n */\nprivate loadImageFile(file: File) {\n        const /** @type {?} */ fileReader = new FileReader();\n        fileReader.onload = (event: any) => {\n            const /** @type {?} */ imageType = file.type;\n            if (this.isValidImageType(imageType)) {\n                this.checkExifRotationAndLoadImage(event.target.result);\n            } else {\n                this.loadImageFailed.emit();\n            }\n        };\n        fileReader.readAsDataURL(file);\n    }\n/**\n * @param {?} type\n * @return {?}\n */\nprivate isValidImageType(type: string) {\n        return type === 'image/jpeg'\n            || type === 'image/jpg'\n            || type === 'image/png'\n            || type === 'image/gif'\n    }\n/**\n * @param {?} imageBase64\n * @return {?}\n */\nprivate checkExifRotationAndLoadImage(imageBase64: string) {\n        const /** @type {?} */ exifRotation = ImageUtils.getOrientation(imageBase64);\n        if (exifRotation > 1) {\n            ImageUtils.resetOrientation(\n                imageBase64,\n                exifRotation,\n                (rotatedBase64: string) => this.loadBase64Image(rotatedBase64)\n            );\n        } else {\n            this.loadBase64Image(imageBase64);\n        }\n    }\n/**\n * @param {?} imageBase64\n * @return {?}\n */\nprivate loadBase64Image(imageBase64: string) {\n        this.originalImage = new Image();\n        this.originalImage.onload = () => {\n            this.originalSize.width = this.originalImage.width;\n            this.originalSize.height = this.originalImage.height;\n            this.cd.markForCheck();\n        };\n        this.safeImgDataUrl = this.sanitizer.bypassSecurityTrustResourceUrl(imageBase64);\n        this.originalImage.src = imageBase64;\n    }\n/**\n * @return {?}\n */\nimageLoadedInView(): void {\n        if (this.originalImage != null) {\n            this.imageLoaded.emit();\n            setTimeout(() => {\n                this.setMaxSize();\n                this.resetCropperPosition();\n                this.cd.markForCheck();\n            });\n        }\n    }\n/**\n * @param {?} event\n * @return {?}\n */\nonResize(event: Event) {\n        this.resizeCropperPosition();\n        this.setMaxSize();\n    }\n/**\n * @return {?}\n */\nprivate resizeCropperPosition() {\n        const /** @type {?} */ displayedImage = this.elementRef.nativeElement.querySelector('.source-image');\n        if (this.maxSize.width !== displayedImage.offsetWidth || this.maxSize.height !== displayedImage.offsetHeight) {\n            this.cropper.x1 = this.cropper.x1 * displayedImage.offsetWidth / this.maxSize.width;\n            this.cropper.x2 = this.cropper.x2 * displayedImage.offsetWidth / this.maxSize.width;\n            this.cropper.y1 = this.cropper.y1 * displayedImage.offsetHeight / this.maxSize.height;\n            this.cropper.y2 = this.cropper.y2 * displayedImage.offsetHeight / this.maxSize.height;\n        }\n    }\n/**\n * @return {?}\n */\nprivate resetCropperPosition() {\n        const /** @type {?} */ displayedImage = this.elementRef.nativeElement.querySelector('.source-image');\n        if (displayedImage.offsetWidth / this.aspectRatio < displayedImage.offsetHeight) {\n            this.cropper.x1 = 0;\n            this.cropper.x2 = displayedImage.offsetWidth;\n            const /** @type {?} */ cropperHeight = displayedImage.offsetWidth / this.aspectRatio;\n            this.cropper.y1 = (displayedImage.offsetHeight - cropperHeight) / 2;\n            this.cropper.y2 = this.cropper.y1 + cropperHeight;\n        } else {\n            this.cropper.y1 = 0;\n            this.cropper.y2 = displayedImage.offsetHeight;\n            const /** @type {?} */ cropperWidth = displayedImage.offsetHeight * this.aspectRatio;\n            this.cropper.x1 = (displayedImage.offsetWidth - cropperWidth) / 2;\n            this.cropper.x2 = this.cropper.x1 + cropperWidth;\n        }\n        this.crop();\n        this.imageVisible = true;\n    }\n/**\n * @param {?} event\n * @param {?} moveType\n * @param {?=} position\n * @return {?}\n */\nstartMove(event: any, moveType: string, position: string | null = null) {\n        this.moveStart.active = true;\n        this.moveStart.type = moveType;\n        this.moveStart.position = position;\n        this.moveStart.clientX = this.getClientX(event);\n        this.moveStart.clientY = this.getClientY(event);\n        Object.assign(this.moveStart, this.cropper);\n        this.cd.markForCheck();\n    }\n/**\n * @param {?} event\n * @return {?}\n */\nmoveImg(event: any) {\n        if (this.moveStart.active) {\n            event.stopPropagation();\n            event.preventDefault();\n            this.setMaxSize();\n            if (this.moveStart.type === 'move') {\n                this.move(event);\n                this.checkCropperPosition(true);\n            } else if (this.moveStart.type === 'resize') {\n                this.resize(event);\n                this.checkCropperPosition(false);\n            }\n            this.cd.markForCheck();\n        }\n    }\n/**\n * @return {?}\n */\nprivate setMaxSize() {\n        const /** @type {?} */ el = this.elementRef.nativeElement.querySelector('.source-image');\n        this.maxSize.width = el.offsetWidth;\n        this.maxSize.height = el.offsetHeight;\n        this.marginLeft = this.sanitizer.bypassSecurityTrustStyle('calc(50% - ' + this.maxSize.width / 2 + 'px)');\n    }\n/**\n * @param {?=} maintainSize\n * @return {?}\n */\nprivate checkCropperPosition(maintainSize = false) {\n        if (this.cropper.x1 < 0) {\n            this.cropper.x2 -= maintainSize ? this.cropper.x1 : 0;\n            this.cropper.x1 = 0;\n        }\n        if (this.cropper.y1 < 0) {\n            this.cropper.y2 -= maintainSize ? this.cropper.y1 : 0;\n            this.cropper.y1 = 0;\n        }\n        if (this.cropper.x2 > this.maxSize.width) {\n            this.cropper.x1 -= maintainSize ? (this.cropper.x2 - this.maxSize.width) : 0;\n            this.cropper.x2 = this.maxSize.width;\n        }\n        if (this.cropper.y2 > this.maxSize.height) {\n            this.cropper.y1 -= maintainSize ? (this.cropper.y2 - this.maxSize.height) : 0;\n            this.cropper.y2 = this.maxSize.height;\n        }\n    }\n/**\n * @param {?} event\n * @return {?}\n */\nmoveStop(event: any) {\n        if (this.moveStart.active) {\n            this.moveStart.active = false;\n            this.crop();\n            this.cd.markForCheck();\n        }\n    }\n/**\n * @param {?} event\n * @return {?}\n */\nprivate move(event: any) {\n        const /** @type {?} */ diffX = this.getClientX(event) - this.moveStart.clientX;\n        const /** @type {?} */ diffY = this.getClientY(event) - this.moveStart.clientY;\n\n        this.cropper.x1 = this.moveStart.x1 + diffX;\n        this.cropper.y1 = this.moveStart.y1 + diffY;\n        this.cropper.x2 = this.moveStart.x2 + diffX;\n        this.cropper.y2 = this.moveStart.y2 + diffY;\n    }\n/**\n * @param {?} event\n * @return {?}\n */\nprivate resize(event: any) {\n        const /** @type {?} */ diffX = this.getClientX(event) - this.moveStart.clientX;\n        const /** @type {?} */ diffY = this.getClientY(event) - this.moveStart.clientY;\n        switch (this.moveStart.position) {\n            case 'left':\n                this.cropper.x1 = Math.min(this.moveStart.x1 + diffX, this.cropper.x2 - 20);\n                break;\n            case 'topleft':\n                this.cropper.x1 = Math.min(this.moveStart.x1 + diffX, this.cropper.x2 - 20);\n                this.cropper.y1 = Math.min(this.moveStart.y1 + diffY, this.cropper.y2 - 20);\n                break;\n            case 'top':\n                this.cropper.y1 = Math.min(this.moveStart.y1 + diffY, this.cropper.y2 - 20);\n                break;\n            case 'topright':\n                this.cropper.x2 = Math.max(this.moveStart.x2 + diffX, this.cropper.x1 + 20);\n                this.cropper.y1 = Math.min(this.moveStart.y1 + diffY, this.cropper.y2 - 20);\n                break;\n            case 'right':\n                this.cropper.x2 = Math.max(this.moveStart.x2 + diffX, this.cropper.x1 + 20);\n                break;\n            case 'bottomright':\n                this.cropper.x2 = Math.max(this.moveStart.x2 + diffX, this.cropper.x1 + 20);\n                this.cropper.y2 = Math.max(this.moveStart.y2 + diffY, this.cropper.y1 + 20);\n                break;\n            case 'bottom':\n                this.cropper.y2 = Math.max(this.moveStart.y2 + diffY, this.cropper.y1 + 20);\n                break;\n            case 'bottomleft':\n                this.cropper.x1 = Math.min(this.moveStart.x1 + diffX, this.cropper.x2 - 20);\n                this.cropper.y2 = Math.max(this.moveStart.y2 + diffY, this.cropper.y1 + 20);\n                break;\n        }\n\n        if (this.maintainAspectRatio) {\n            this.checkAspectRatio();\n        }\n    }\n/**\n * @return {?}\n */\nprivate checkAspectRatio() {\n        let /** @type {?} */ overflowX = 0;\n        let /** @type {?} */ overflowY = 0;\n\n        switch (this.moveStart.position) {\n            case 'top':\n                this.cropper.x2 = this.cropper.x1 + (this.cropper.y2 - this.cropper.y1) * this.aspectRatio;\n                overflowX = Math.max(this.cropper.x2 - this.maxSize.width, 0);\n                overflowY = Math.max(0 - this.cropper.y1, 0);\n                if (overflowX > 0 || overflowY > 0) {\n                    this.cropper.x2 -= (overflowY * this.aspectRatio) > overflowX ? (overflowY * this.aspectRatio) : overflowX;\n                    this.cropper.y1 += (overflowY * this.aspectRatio) > overflowX ? overflowY : overflowX / this.aspectRatio;\n                }\n                break;\n            case 'bottom':\n                this.cropper.x2 = this.cropper.x1 + (this.cropper.y2 - this.cropper.y1) * this.aspectRatio;\n                overflowX = Math.max(this.cropper.x2 - this.maxSize.width, 0);\n                overflowY = Math.max(this.cropper.y2 - this.maxSize.height, 0);\n                if (overflowX > 0 || overflowY > 0) {\n                    this.cropper.x2 -= (overflowY * this.aspectRatio) > overflowX ? (overflowY * this.aspectRatio) : overflowX;\n                    this.cropper.y2 -= (overflowY * this.aspectRatio) > overflowX ? overflowY : (overflowX / this.aspectRatio);\n                }\n                break;\n            case 'topleft':\n                this.cropper.y1 = this.cropper.y2 - (this.cropper.x2 - this.cropper.x1) / this.aspectRatio;\n                overflowX = Math.max(0 - this.cropper.x1, 0);\n                overflowY = Math.max(0 - this.cropper.y1, 0);\n                if (overflowX > 0 || overflowY > 0) {\n                    this.cropper.x1 += (overflowY * this.aspectRatio) > overflowX ? (overflowY * this.aspectRatio) : overflowX;\n                    this.cropper.y1 += (overflowY * this.aspectRatio) > overflowX ? overflowY : overflowX / this.aspectRatio;\n                }\n                break;\n            case 'topright':\n                this.cropper.y1 = this.cropper.y2 - (this.cropper.x2 - this.cropper.x1) / this.aspectRatio;\n                overflowX = Math.max(this.cropper.x2 - this.maxSize.width, 0);\n                overflowY = Math.max(0 - this.cropper.y1, 0);\n                if (overflowX > 0 || overflowY > 0) {\n                    this.cropper.x2 -= (overflowY * this.aspectRatio) > overflowX ? (overflowY * this.aspectRatio) : overflowX;\n                    this.cropper.y1 += (overflowY * this.aspectRatio) > overflowX ? overflowY : overflowX / this.aspectRatio;\n                }\n                break;\n            case 'right':\n            case 'bottomright':\n                this.cropper.y2 = this.cropper.y1 + (this.cropper.x2 - this.cropper.x1) / this.aspectRatio;\n                overflowX = Math.max(this.cropper.x2 - this.maxSize.width, 0);\n                overflowY = Math.max(this.cropper.y2 - this.maxSize.height, 0);\n                if (overflowX > 0 || overflowY > 0) {\n                    this.cropper.x2 -= (overflowY * this.aspectRatio) > overflowX ? (overflowY * this.aspectRatio) : overflowX;\n                    this.cropper.y2 -= (overflowY * this.aspectRatio) > overflowX ? overflowY : overflowX / this.aspectRatio;\n                }\n                break;\n            case 'left':\n            case 'bottomleft':\n                this.cropper.y2 = this.cropper.y1 + (this.cropper.x2 - this.cropper.x1) / this.aspectRatio;\n                overflowX = Math.max(0 - this.cropper.x1, 0);\n                overflowY = Math.max(this.cropper.y2 - this.maxSize.height, 0);\n                if (overflowX > 0 || overflowY > 0) {\n                    this.cropper.x1 += (overflowY * this.aspectRatio) > overflowX ? (overflowY * this.aspectRatio) : overflowX;\n                    this.cropper.y2 -= (overflowY * this.aspectRatio) > overflowX ? overflowY : overflowX / this.aspectRatio;\n                }\n                break;\n        }\n    }\n/**\n * @return {?}\n */\nprivate crop() {\n        const /** @type {?} */ displayedImage = this.elementRef.nativeElement.querySelector('.source-image');\n        if (displayedImage && this.originalImage != null) {\n            const /** @type {?} */ ratio = this.originalSize.width / displayedImage.offsetWidth;\n            const /** @type {?} */ left = Math.round(this.cropper.x1 * ratio);\n            const /** @type {?} */ top = Math.round(this.cropper.y1 * ratio);\n            const /** @type {?} */ width = Math.round((this.cropper.x2 - this.cropper.x1) * ratio);\n            const /** @type {?} */ height = Math.round((this.cropper.y2 - this.cropper.y1) * ratio);\n            const /** @type {?} */ resizeRatio = this.getResizeRatio(width);\n            const /** @type {?} */ cropCanvas = /** @type {?} */(( document.createElement('canvas') as HTMLCanvasElement));\n            cropCanvas.width = width * resizeRatio;\n            cropCanvas.height = height * resizeRatio;\n            const /** @type {?} */ ctx = cropCanvas.getContext('2d');\n            if (ctx) {\n                ctx.drawImage(this.originalImage, left, top, width, height, 0, 0, width * resizeRatio, height * resizeRatio);\n                const /** @type {?} */ quality = Math.min(1, Math.max(0, this.imageQuality / 100));\n                const /** @type {?} */ croppedImage = cropCanvas.toDataURL('image/' + this.format, quality);\n                if (croppedImage.length > 10) {\n                    this.imageCropped.emit(croppedImage);\n                }\n            }\n        }\n    }\n/**\n * @param {?} width\n * @return {?}\n */\nprivate getResizeRatio(width: number): number {\n        return this.resizeToWidth > 0 && (!this.onlyScaleDown || width > this.resizeToWidth)\n            ? this.resizeToWidth / width\n            : 1;\n    }\n/**\n * @param {?} event\n * @return {?}\n */\nprivate getClientX(event: any) {\n        return event.clientX != null ? event.clientX : event.touches[0].clientX;\n    }\n/**\n * @param {?} event\n * @return {?}\n */\nprivate getClientY(event: any) {\n        return event.clientY != null ? event.clientY : event.touches[0].clientY;\n    }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n    selector: 'image-cropper',\n    template: `\n      <div>\n          <img\n              [src]=\"safeImgDataUrl\"\n              [style.visibility]=\"imageVisible ? 'visible' : 'hidden'\"\n              (load)=\"imageLoadedInView()\"\n              class=\"source-image\"\n          />\n          <div class=\"cropper\"\n               [style.top.px]=\"cropper.y1\"\n               [style.left.px]=\"cropper.x1\"\n               [style.width.px]=\"cropper.x2 - cropper.x1\"\n               [style.height.px]=\"cropper.y2 - cropper.y1\"\n               [style.margin-left]=\"marginLeft\"\n               [style.visibility]=\"imageVisible ? 'visible' : 'hidden'\"\n          >\n              <div\n                  (mousedown)=\"startMove($event, 'move')\"\n                  (touchstart)=\"startMove($event, 'move')\"\n                  class=\"move\"\n              >&nbsp;</div>\n              <span\n                  class=\"resize topleft\"\n                  (mousedown)=\"startMove($event, 'resize', 'topleft')\"\n                  (touchstart)=\"startMove($event, 'resize', 'topleft')\"\n              ><span class=\"square\"></span></span>\n              <span\n                  class=\"resize top\"\n              ><span class=\"square\"></span></span>\n              <span\n                  class=\"resize topright\"\n                  (mousedown)=\"startMove($event, 'resize', 'topright')\"\n                  (touchstart)=\"startMove($event, 'resize', 'topright')\"\n              ><span class=\"square\"></span></span>\n              <span\n                  class=\"resize right\"\n              ><span class=\"square\"></span></span>\n              <span\n                  class=\"resize bottomright\"\n                  (mousedown)=\"startMove($event, 'resize', 'bottomright')\"\n                  (touchstart)=\"startMove($event, 'resize', 'bottomright')\"\n              ><span class=\"square\"></span></span>\n              <span\n                  class=\"resize bottom\"\n              ><span class=\"square\"></span></span>\n              <span\n                  class=\"resize bottomleft\"\n                  (mousedown)=\"startMove($event, 'resize', 'bottomleft')\"\n                  (touchstart)=\"startMove($event, 'resize', 'bottomleft')\"\n              ><span class=\"square\"></span></span>\n              <span\n                  class=\"resize left\"\n              ><span class=\"square\"></span></span>\n              <span\n                  class=\"resize-bar top\"\n                  (mousedown)=\"startMove($event, 'resize', 'top')\"\n                  (touchstart)=\"startMove($event, 'resize', 'top')\"\n              ></span>\n              <span\n                  class=\"resize-bar right\"\n                  (mousedown)=\"startMove($event, 'resize', 'right')\"\n                  (touchstart)=\"startMove($event, 'resize', 'right')\"\n              ></span>\n              <span\n                  class=\"resize-bar bottom\"\n                  (mousedown)=\"startMove($event, 'resize', 'bottom')\"\n                  (touchstart)=\"startMove($event, 'resize', 'bottom')\"\n              ></span>\n              <span\n                  class=\"resize-bar left\"\n                  (mousedown)=\"startMove($event, 'resize', 'left')\"\n                  (touchstart)=\"startMove($event, 'resize', 'left')\"\n              ></span>\n          </div>\n      </div>\n    `,\n    styles: [`\n      :host {\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        position: relative;\n        width: 100%;\n        max-width: 100%;\n        max-height: 100%;\n        overflow: hidden;\n        padding: 5px;\n        text-align: center;\n        -webkit-user-select: none;\n        -moz-user-select: none;\n        -ms-user-select: none;\n        user-select: none; }\n        :host > div {\n          position: relative;\n          width: 100%; }\n          :host > div .source-image {\n            max-width: 100%;\n            max-height: 100%; }\n        :host .cropper {\n          position: absolute;\n          display: -webkit-box;\n          display: -ms-flexbox;\n          display: flex;\n          color: #53535C !important;\n          background: transparent !important;\n          outline-color: rgba(255, 255, 255, 0.3);\n          outline-width: 1000px;\n          outline-style: solid;\n          -ms-touch-action: none;\n              touch-action: none; }\n          :host .cropper:after {\n            position: absolute;\n            content: '';\n            top: 0;\n            bottom: 0;\n            left: 0;\n            right: 0;\n            pointer-events: none;\n            border: dashed 1px;\n            opacity: .75;\n            color: inherit;\n            z-index: 1; }\n          :host .cropper .move {\n            width: 100%;\n            cursor: move;\n            border: 1px solid rgba(255, 255, 255, 0.5); }\n          :host .cropper .resize {\n            position: absolute;\n            display: inline-block;\n            line-height: 6px;\n            padding: 8px;\n            opacity: .85;\n            z-index: 1; }\n            :host .cropper .resize .square {\n              display: inline-block;\n              background: #53535C !important;\n              width: 6px;\n              height: 6px;\n              border: 1px solid rgba(255, 255, 255, 0.5); }\n            :host .cropper .resize.topleft {\n              top: -12px;\n              left: -12px;\n              cursor: nw-resize; }\n            :host .cropper .resize.top {\n              top: -12px;\n              left: calc(50% - 12px);\n              cursor: n-resize; }\n            :host .cropper .resize.topright {\n              top: -12px;\n              right: -12px;\n              cursor: ne-resize; }\n            :host .cropper .resize.right {\n              top: calc(50% - 12px);\n              right: -12px;\n              cursor: e-resize; }\n            :host .cropper .resize.bottomright {\n              bottom: -12px;\n              right: -12px;\n              cursor: se-resize; }\n            :host .cropper .resize.bottom {\n              bottom: -12px;\n              left: calc(50% - 12px);\n              cursor: s-resize; }\n            :host .cropper .resize.bottomleft {\n              bottom: -12px;\n              left: -12px;\n              cursor: sw-resize; }\n            :host .cropper .resize.left {\n              top: calc(50% - 12px);\n              left: -12px;\n              cursor: w-resize; }\n          :host .cropper .resize-bar {\n            position: absolute;\n            z-index: 1; }\n            :host .cropper .resize-bar.top {\n              top: -11px;\n              left: 11px;\n              width: calc(100% - 22px);\n              height: 22px;\n              cursor: n-resize; }\n            :host .cropper .resize-bar.right {\n              top: 11px;\n              right: -11px;\n              height: calc(100% - 22px);\n              width: 22px;\n              cursor: e-resize; }\n            :host .cropper .resize-bar.bottom {\n              bottom: -11px;\n              left: 11px;\n              width: calc(100% - 22px);\n              height: 22px;\n              cursor: s-resize; }\n            :host .cropper .resize-bar.left {\n              top: 11px;\n              left: -11px;\n              height: calc(100% - 22px);\n              width: 22px;\n              cursor: w-resize; }\n    `],\n    changeDetection: ChangeDetectionStrategy.OnPush\n}, ] },\n];\n/**\n * @nocollapse\n */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ElementRef, },\n{type: DomSanitizer, },\n{type: ChangeDetectorRef, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'imageFileChanged': [{ type: Input },],\n'imageChangedEvent': [{ type: Input },],\n'imageBase64': [{ type: Input },],\n'format': [{ type: Input },],\n'maintainAspectRatio': [{ type: Input },],\n'aspectRatio': [{ type: Input },],\n'resizeToWidth': [{ type: Input },],\n'onlyScaleDown': [{ type: Input },],\n'imageQuality': [{ type: Input },],\n'cropper': [{ type: Input },],\n'imageCropped': [{ type: Output },],\n'imageLoaded': [{ type: Output },],\n'loadImageFailed': [{ type: Output },],\n'onResize': [{ type: HostListener, args: ['window:resize', ['$event'], ] },],\n'moveImg': [{ type: HostListener, args: ['document:mousemove', ['$event'], ] },{ type: HostListener, args: ['document:touchmove', ['$event'], ] },],\n'moveStop': [{ type: HostListener, args: ['document:mouseup', ['$event'], ] },{ type: HostListener, args: ['document:touchend', ['$event'], ] },],\n};\n}\n\nfunction ImageCropperComponent_tsickle_Closure_declarations() {\n/** @type {?} */\nImageCropperComponent.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nImageCropperComponent.ctorParameters;\n/** @type {?} */\nImageCropperComponent.propDecorators;\n/** @type {?} */\nImageCropperComponent.prototype.originalImage;\n/** @type {?} */\nImageCropperComponent.prototype.moveStart;\n/** @type {?} */\nImageCropperComponent.prototype.maxSize;\n/** @type {?} */\nImageCropperComponent.prototype.originalSize;\n/** @type {?} */\nImageCropperComponent.prototype.safeImgDataUrl;\n/** @type {?} */\nImageCropperComponent.prototype.marginLeft;\n/** @type {?} */\nImageCropperComponent.prototype.imageVisible;\n/** @type {?} */\nImageCropperComponent.prototype.format;\n/** @type {?} */\nImageCropperComponent.prototype.maintainAspectRatio;\n/** @type {?} */\nImageCropperComponent.prototype.aspectRatio;\n/** @type {?} */\nImageCropperComponent.prototype.resizeToWidth;\n/** @type {?} */\nImageCropperComponent.prototype.onlyScaleDown;\n/** @type {?} */\nImageCropperComponent.prototype.imageQuality;\n/** @type {?} */\nImageCropperComponent.prototype.cropper;\n/** @type {?} */\nImageCropperComponent.prototype.imageCropped;\n/** @type {?} */\nImageCropperComponent.prototype.imageLoaded;\n/** @type {?} */\nImageCropperComponent.prototype.loadImageFailed;\n/** @type {?} */\nImageCropperComponent.prototype.elementRef;\n/** @type {?} */\nImageCropperComponent.prototype.sanitizer;\n/** @type {?} */\nImageCropperComponent.prototype.cd;\n}\n\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ImageCropperComponent } from './image-cropper.component';\nexport class ImageCropperModule {static decorators: DecoratorInvocation[] = [\n{ type: NgModule, args: [{\n    imports: [\n        CommonModule\n    ],\n    declarations: [\n        ImageCropperComponent\n    ],\n    exports: [\n        ImageCropperComponent\n    ]\n}, ] },\n];\n/**\n * @nocollapse\n */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n];\n}\n\nfunction ImageCropperModule_tsickle_Closure_declarations() {\n/** @type {?} */\nImageCropperModule.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nImageCropperModule.ctorParameters;\n}\n\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport {ImageCropperModule,ImageCropperComponent} from './index';\n"]},"metadata":{},"sourceType":"module"}